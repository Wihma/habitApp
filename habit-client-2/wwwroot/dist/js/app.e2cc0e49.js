(function(t){function e(e){for(var r,i,s=e[0],u=e[1],l=e[2],c=0,d=[];c<s.length;c++)i=s[c],a[i]&&d.push(a[i][0]),a[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);f&&f(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,i=1;i<n.length;i++){var s=n[i];0!==a[s]&&(r=!1)}r&&(o.splice(e--,1),t=u(u.s=n[0]))}return t}var r={},i={app:0},a={app:0},o=[];function s(t){return u.p+"js/"+({about:"about"}[t]||t)+"."+{about:"1262e102"}[t]+".js"}function u(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(t){var e=[],n={about:1};i[t]?e.push(i[t]):0!==i[t]&&n[t]&&e.push(i[t]=new Promise(function(e,n){for(var r="css/"+({about:"about"}[t]||t)+"."+{about:"e26f3084"}[t]+".css",a=u.p+r,o=document.getElementsByTagName("link"),s=0;s<o.length;s++){var l=o[s],c=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(c===r||c===a))return e()}var d=document.getElementsByTagName("style");for(s=0;s<d.length;s++){l=d[s],c=l.getAttribute("data-href");if(c===r||c===a)return e()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=e,f.onerror=function(e){var r=e&&e.target&&e.target.src||a,o=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=r,delete i[t],f.parentNode.removeChild(f),n(o)},f.href=a;var h=document.getElementsByTagName("head")[0];h.appendChild(f)}).then(function(){i[t]=0}));var r=a[t];if(0!==r)if(r)e.push(r[2]);else{var o=new Promise(function(e,n){r=a[t]=[e,n]});e.push(r[2]=o);var l,c=document.createElement("script");c.charset="utf-8",c.timeout=120,u.nc&&c.setAttribute("nonce",u.nc),c.src=s(t),l=function(e){c.onerror=c.onload=null,clearTimeout(d);var n=a[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src,o=new Error("Loading chunk "+t+" failed.\n("+r+": "+i+")");o.type=r,o.request=i,n[1](o)}a[t]=void 0}};var d=setTimeout(function(){l({type:"timeout",target:c})},12e4);c.onerror=c.onload=l,document.head.appendChild(c)}return Promise.all(e)},u.m=t,u.c=r,u.d=function(t,e,n){u.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},u.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.t=function(t,e){if(1&e&&(t=u(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)u.d(n,r,function(e){return t[e]}.bind(null,r));return n},u.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return u.d(e,"a",e),e},u.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},u.p="/",u.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=e,l=l.slice();for(var d=0;d<l.length;d++)e(l[d]);var f=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),i=n("bb71");n("da64");r["a"].use(i["a"],{iconfont:"md"});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("toolbar"),n("navigation"),n("v-content",[n("router-view")],1)],1)},o=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-toolbar",{attrs:{app:"",dark:""}},[n("v-toolbar-title",{staticClass:"headline text-uppercase"},[n("span",[t._v("VÃ¤nliga")]),n("span",{staticClass:"font-weight-light"},[t._v("Vanor")])]),n("v-spacer"),t.isLoggedIn?t._e():n("v-btn",{attrs:{outline:"",dark:"",color:"white"},on:{click:t.login}},[n("span",[t._v("Login")])]),t.isLoggedIn?n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-width":200,"offset-x":""},model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[n("v-btn",{attrs:{slot:"activator",color:"grey lighten-1",dark:"",icon:""},slot:"activator"},[n("v-icon",[t._v("person")])],1),n("v-card",[n("v-list",[n("v-list-tile",{attrs:{avatar:""}},[n("v-list-tile-avatar",[n("img",{attrs:{src:"https://www.facebook.com/photo.php?fbid=10155542058860917&set=a.468908170916&type=3&source=11&referrer_profile_id=709060916",alt:"Marc"}})]),n("v-list-tile-content",[n("v-list-tile-title",[t._v("Marc Wihlstrand")]),n("v-list-tile-sub-title",[t._v("Founder of this HabitApp")])],1),n("v-list-tile-action",[n("v-btn",{attrs:{icon:""}},[n("v-icon",[t._v("settings")])],1)],1)],1)],1),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{flat:""},on:{click:function(e){t.menu=!1}}},[t._v("Cancel")]),n("v-btn",{attrs:{color:"primary",flat:""},on:{click:t.logout}},[t._v("Logout")])],1)],1)],1):t._e()],1)},u=[],l={data:function(){return{menu:!1}},computed:{isLoggedIn:function(){return this.$store.getters.isLoggedIn}},methods:{login:function(){this.$router.push("/login")},logout:function(){this.$store.dispatch("logout"),this.$router.push("/login")}},mounted:function(){}},c=l,d=n("2877"),f=n("6544"),h=n.n(f),b=n("8336"),m=n("b0af"),p=n("99d9"),v=n("ce7e6"),g=n("132d"),y=n("8860"),w=n("ba95"),I=n("40fe"),_=n("c954"),H=n("5d23"),L=n("e449"),T=n("9910"),S=n("71d9"),x=n("2a7f"),A=Object(d["a"])(c,s,u,!1,null,null,null),V=A.exports;h()(A,{VBtn:b["a"],VCard:m["a"],VCardActions:p["a"],VDivider:v["a"],VIcon:g["a"],VList:y["a"],VListTile:w["a"],VListTileAction:I["a"],VListTileAvatar:_["a"],VListTileContent:H["a"],VListTileSubTitle:H["b"],VListTileTitle:H["c"],VMenu:L["a"],VSpacer:T["a"],VToolbar:S["a"],VToolbarTitle:x["a"]});var P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isLoggedIn?n("v-navigation-drawer",{staticStyle:{position:"fixed",top:"64px"},attrs:{clipped:"",permanent:"","mini-variant":t.mini,"hide-overlay":"",stateless:""},on:{"update:miniVariant":function(e){t.mini=e},"update:mini-variant":function(e){t.mini=e}},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[n("v-toolbar",{staticClass:"transparent",attrs:{flat:""}},[n("v-list",{staticClass:"pa-0"},[n("v-list-tile",[n("v-list-tile-avatar",[n("v-icon",{staticStyle:{cursor:"pointer"}},[t._v("\n                menu\n              ")])],1),n("v-list-tile-content",[n("v-list-tile-title",[t._v("Menu")])],1),n("v-list-tile-action",[n("v-btn",{attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.mini=!t.mini}}},[n("v-icon",[t._v("chevron_left")])],1)],1)],1)],1)],1),n("v-list",{staticClass:"pt-0",attrs:{dense:""}},[n("v-divider"),t._l(t.items,function(e){return n("v-list-tile",{key:e.title},[n("v-list-tile-action",[n("v-btn",{attrs:{flat:"",icon:"",to:e.route}},[n("v-icon",{staticStyle:{cursor:"pointer"}},[t._v(t._s(e.icon)+"\n            ")])],1)],1),n("v-list-tile-content",[n("v-list-tile-title",[t._v(t._s(e.title))])],1)],1)})],2)],1):t._e()},j=[],k={data:function(){return{drawer:!0,items:[{title:"Habit List",icon:"question_answer",route:"/habits"},{title:"Todays Habits",icon:"today",route:"/todayshabits"},{title:"Templates",icon:"folder",route:"/templates"},{title:"User Settings",icon:"settings",route:"/user/settings"},{title:"Archived Habits",icon:"archive",route:"/archivedhabits"}],mini:!0,right:null}},computed:{isLoggedIn:function(){return this.$store.getters.isLoggedIn}},mounted:function(){}},C=k,E=n("f774"),O=Object(d["a"])(C,P,j,!1,null,null,null),U=O.exports;h()(O,{VBtn:b["a"],VDivider:v["a"],VIcon:g["a"],VList:y["a"],VListTile:w["a"],VListTileAction:I["a"],VListTileAvatar:_["a"],VListTileContent:H["a"],VListTileTitle:H["c"],VNavigationDrawer:E["a"],VToolbar:S["a"]});var $={name:"App",components:{toolbar:V,navigation:U},data:function(){return{}}},F=$,M=n("7496"),N=n("549c"),B=Object(d["a"])(F,a,o,!1,null,null,null),D=B.exports;h()(B,{VApp:M["a"],VContent:N["a"]});var q=n("cebc"),J=(n("7f7f"),n("8c4f")),W=n("2f62"),K=n("bfa9"),R=n("bc3a"),G=n.n(R),z=function(){return G.a.create({baseURL:"http://localhost:8000/api"})},Q={login:function(t,e){return z().post("user/login",{email:t,password:e}).then(X,X).catch(function(t){return console.log({status:"error",err:t}),Promise.reject(t)})}};function X(t){var e,n;if(console.log({res:t}),t.status?(e=t.data,n=t):(e=t.response.data,n=t.response),console.log({message:"handle response",response:n}),200!==n.status||"OK"!==n.statusText){n.status;var r=e&&e.message||n.statusText;return Promise.reject(r)}return Promise.resolve(e)}var Y={state:{user:{isLoggedIn:!1,userId:""}},getters:{isLoggedIn:function(t){return t.user.isLoggedIn},currentUserId:function(t){return t.user.userId}},mutations:{logout:function(t){t.user.isLoggedIn=!1},loginRequest:function(t){t.pending=!0},loginSuccess:function(t){t.pending=!1,t.user.isLoggedIn=!0},setCurrentuserId:function(t,e){null!==localStorage.getItem("userId")&&""!==localStorage.getItem("userId")&&localStorage.getItem("userId").length>5?t.user.userId=localStorage.getItem("userId"):t.user.userId=e},jwtActive:function(t){t.user.isLoggedIn=!0}},actions:{login:function(t,e){t.dispatch;var n=t.commit,r=e.email,i=e.password;return n("loginRequest"),new Promise(function(t,e){Q.login(r,i).then(function(e){n("loginSuccess"),n("setCurrentuserId",e.userId),localStorage.setItem("jwt",e.token),localStorage.setItem("userId",e.userId),t(e)},function(t){e(t)}).catch(function(t){console.log(t)})})},logout:function(t){var e=t.commit;return e("logout"),localStorage.removeItem("jwt"),!0}}},Z=(n("20d6"),n("55dd"),n("7514"),n("ac6a"),n("456d"),{getAll:function(){return z().get("habit/all").then(tt).then(function(t){return t})},getAllHabitsForUser:function(t){return z().get("habit/getAllHabitsForUser",{params:{userId:t}}).then(tt).then(function(t){return t})},performed:function(t,e){return z().post("habit/habitPerformed",{habitId:t,dayPerformed:e}).then(tt).then(function(t){})},new:function(t,e){return z().post("habit/new",{userId:t,habit:e}).then(tt).then(function(t){return t})},update:function(t){return z().put("habit/update",{habit:t}).then(tt).then(function(t){return t})},delete:function(t){return z().delete("habit/delete",{data:{id:t}}).then(tt).then(function(t){return null})}});function tt(t){var e=t.data;if(200!==t.status||"OK"!==t.statusText){401===t.status&&location.reload(!0);var n=e&&e.message||t.statusText;return Promise.reject(n)}return e}var et={state:{newHabit:{selectedWeekdays:[0,1,2,3,4,5,6],time:"12:00",active:!0,measureWUnit:!1,measureTime:!0},habits:[],habitsPerformed:[]},getters:{allUserHabits:function(t){if(Object.keys(t.habits).length>0)return t.habits.filter(function(t){return!0===t.active})},allArchivedHabits:function(t){if(t.habits.lenght>0)return t.habits.filter(function(t){return!1===t.active})},getHabitById:function(t){return function(e){if("-1"===e){var n=JSON.stringify(t.newHabit);return JSON.parse(n)}return t.habits.find(function(t){return t._id===e})}},getHabitPerformedId:function(t){return function(e){return t.habitsPerformed.find(function(t){return t.id===parseInt(e)})}},getHabitPerformedByHabitId:function(t){return function(e){return t.habitsPerformed.find(function(t){return t.habitId===parseInt(e)})}},getTodaysHabits:function(t){var e=new Date,n=e.getDay(),r=t.habits;if(!(r.length<1))return r=r.filter(function(t){return t.selectedWeekdays.find(function(t){return parseInt(t)===n})}),r=r.filter(function(t){return!0===t.active}),r.sort(function(t,e){return t.time>e.time}),r}},mutations:{getAllHabits:function(t,e){t.habits=e},setAllHabitsForUser:function(t,e){t.habits=e},saveHabit:function(t,e){var n,i=t.habits;try{n=i.findIndex(function(t){return t._id===e._id}),n>-1&&(i.splice(n,1),r["a"].set(t,"habits",e))}catch(a){r["a"].set(t,"habits",e)}},saveTodayPerformed:function(t,e){var n;try{n=t.habits.find(function(t){return t._id===e.habitId}),n.daysPerformed.push(e.dayPerformed)}catch(r){n={id:0,habitId:e.habitId,days:[]},n.days.push(e.dayPerformed),t.habitsPerformed.push(n)}},refreshTodaysHabits:function(t){var e=t.habits;t.habits=null,t.habits=e},deleteHabit:function(t,e){console.log("delete habit"),t.habits.splice(t.habits.findIndex(function(t){return t._id===e}),1)}},actions:{getAllHabits:function(t){t.dispatch;var e=t.commit;return Z.getAll().then(function(t){e("setAllHabits",t)})},getAllHabitsForUser:function(t){t.dispatch;var e=t.commit,n=(t.rootState,t.rootGetters);return Z.getAllHabitsForUser(n.currentUserId).then(function(t){e("setAllHabitsForUser",t)})},newHabit:function(t,e){t.dispatch;var n=t.commit,r=(t.rootState,t.rootGetters),i=e.habit;return console.log({userId:r.currentUserId,habit:i}),Z.new(r.currentUserId,i).then(n("saveHabit",{habit:i}))},updateHabit:function(t,e){t.dispatch;var n=t.commit,r=e.habit;return Z.update(r).then(n("saveHabit",{habit:r}))},saveTodayPerformed:function(t,e){t.dispatch;var n=t.commit,r=e.habitId,i=e.dayPerformed;return Z.performed(r,i).then(n("saveTodayPerformed",{habitId:r,dayPerformed:i}))},deleteHabit:function(t,e){t.dispatch;var n=t.commit,r=e.habitId;return console.log("action delete habit"),Z.delete(r).then(n("deleteHabit",{habitId:r}))}}};r["a"].use(W["a"]);var nt=new K["a"]({key:"vuex",storage:window.localStorage}),rt=new W["a"].Store({modules:{auth:Y,habits:et},state:{},getters:{},mutations:{},actions:{},plugins:[nt.plugin]});function it(t){var e=t.next,n=t.to;return console.log(n.name),e()}function at(t){var e=t.next,n=t.router;return localStorage.getItem("jwt")?(console.log("jwt exists"),e()):(console.log("jwt doesnt exists"),n.push({name:"login"}))}var ot=[it,at],st={Login:"Login",Habits:"Habits"},ut=function(t,e,n){if(!rt.getters.isloggedin)return localStorage.getItem("jwt")&&(rt.commit("jwtActive"),rt.commit("setCurrentuserId"),t.name===st.Login&&n("/habits")),void n();n("/login")};r["a"].use(J["a"]);var lt=new J["a"]({mode:"history",base:"/",routes:[{path:"/",name:"Home",component:function(){return n.e("about").then(n.bind(null,"c895"))},beforeEnter:ut,meta:{middleware:ot}},{path:"/login",name:st.Login,component:function(){return n.e("about").then(n.bind(null,"49a0"))},beforeEnter:ut,meta:{middleware:[it]}},{path:"/habit/:id",name:st.Habits,component:function(){return n.e("about").then(n.bind(null,"e1bc"))},beforeEnter:ut,meta:{middleware:ot}},{path:"/habits",name:"Habits",component:function(){return n.e("about").then(n.bind(null,"d523"))},beforeEnter:ut,meta:{middleware:ot}},{path:"/todayshabits",name:"TodaysHabits",component:function(){return n.e("about").then(n.bind(null,"49ef"))},beforeEnter:ut,meta:{middleware:ot}},{path:"/archivedhabits",name:"ArchivedHabitList",component:function(){return n.e("about").then(n.bind(null,"228e"))},beforeEnter:ut,meta:{middleware:ot}},{path:"/about",name:"about",component:function(){return n.e("about").then(n.bind(null,"e520"))}},{path:"/user/home",name:"Start",component:function(){return n.e("about").then(n.bind(null,"fc51"))},beforeEnter:ut,meta:{middleware:ot}},{path:"/user/settings",name:"UserSettings",component:function(){return n.e("about").then(n.bind(null,"754d"))},beforeEnter:ut,meta:{middleware:ot}}]});function ct(t,e,n){var r=e[n];return r?function(){t.next.apply(t,arguments);var i=ct(t,e,n+1);r(Object(q["a"])({},t,{next:i}))}:t.next}lt.beforeEach(function(t,e,n){if(t.meta.middleware){var r=Array.isArray(t.meta.middleware)?t.meta.middleware:[t.meta.middleware],i={from:e,next:n,router:lt,to:t},a=ct(i,r,1);return r[0](Object(q["a"])({},i,{next:a}))}return n()});var dt=lt;r["a"].config.productionTip=!1,new r["a"]({router:dt,store:rt,render:function(t){return t(D)}}).$mount("#app")}});
//# sourceMappingURL=app.e2cc0e49.js.map